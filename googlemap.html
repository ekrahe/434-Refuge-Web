<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
		<script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
		<script>
			var map;
			var marker;
			var infowindow;

			function initialize() {
				var mapProp = {
					center:new google.maps.LatLng(51.508742,-0.120850),
					zoom:5,
					mapTypeId:google.maps.MapTypeId.ROADMAP
				};
				map=new google.maps.Map(document.getElementById("googleMap"),mapProp);

				google.maps.event.addListener(map,'click',function(event) {
					placeMarker(event.latLng);						  
				});	

            
				// Zoom to 9 when clicking on marker

				google.maps.event.addListener(marker,'click',function() {
					map.setZoom(15);
					map.setCenter(marker.getPosition());
				});
			}


			function placeMarker(location) {
				//Get the location
				var json = 'https://maps.googleapis.com/maps/api/geocode/json?latlng='+location.lat()+','+location.lng()+'&key=AIzaSyAZ0iFbVGyGwV_xPSajV-P2W0OD6_OggMQ';

				//Make http request
				var xhr = new XMLHttpRequest();
				xhr.open("GET",json,false);
				xhr.send();
				var response= xhr.responseText;	
				var object = JSON.parse(response);
				var location_name = object.results[2].formatted_address;
				localStorage.setItem("st_location",location_name);

				//Set the marker
				if(!(marker&&infowindow)) {
					marker = new google.maps.Marker({
						position: location,
						map: map,
					});

					infowindow = new google.maps.InfoWindow({
						content: ''+location_name
					});	

				} else {
					marker.setPosition(location);
					infowindow.setContent(''+location_name);
				}

				infowindow.open(map,marker);
			}



			google.maps.event.addDomListener(window, 'load', initialize);

		</script>
	</head>

	<body style="background: #00BCD4 !important;">
		<div class="container">
			<div class="row text-center">
				<h1>REFUGE</h1>
				<h3>Set Location</h3>
			</div>
			<div class="row">
				<div id="googleMap" style="width:100%; height:450px"></div>
			</div>


			<div class="row text-center"  >			
			<a href="event_creationpage.html" type="button" class="btn btn-danger text-center" style="margin:25px" id="cancelled">CANCEL</a> 
			
				<a href="event_creationpage.html" type="button" class="btn btn-success text-center"  name="mlocation" >SET LOCATION</a>
			</div>
		</div>
		
		<script>	
			
			function remove() {
				 localStorage.removeItem("st_location");
			  alert("button was clicked");
			}
		 var oncancel = document.getElementById("cancelled");
			oncancel.addEventListener('click',remove);
		</script>

	</body>

</html>